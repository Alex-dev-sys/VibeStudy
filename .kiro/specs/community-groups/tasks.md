# Implementation Plan

- [x] 1. Настройка базы данных и типов


  - Создать миграцию Supabase для таблиц groups, group_members, group_messages
  - Настроить индексы для оптимизации запросов
  - Настроить Row Level Security (RLS) policies для безопасности
  - Создать TypeScript типы в src/types/groups.ts
  - _Requirements: 1.1, 2.1, 3.1, 4.1_



- [ ] 2. Создать Zustand store для управления группами
  - Реализовать groups-store.ts с состоянием и действиями
  - Добавить persist middleware для локального кэширования
  - Реализовать методы для CRUD операций с группами
  - Реализовать методы для управления участниками
  - Реализовать методы для работы с сообщениями



  - Добавить фильтрацию и поиск групп
  - _Requirements: 1.1, 1.3, 1.4, 2.1, 3.1, 4.1_

- [ ] 3. Создать Supabase queries для работы с группами
  - Реализовать src/lib/supabase/groups.ts с функциями запросов

  - Добавить функции для CRUD операций с группами


  - Добавить функции для управления участниками
  - Добавить функции для работы с сообщениями
  - Добавить проверки лимитов (3 созданные группы, 10 участий)
  - _Requirements: 2.1, 2.7, 3.1, 3.4, 4.1_

- [ ] 4. Создать API routes для групп
- [x] 4.1 Реализовать API для CRUD операций с группами


  - Создать POST /api/groups для создания группы
  - Создать GET /api/groups для получения списка групп с фильтрами
  - Создать GET /api/groups/[id] для получения деталей группы
  - Создать PATCH /api/groups/[id] для обновления группы
  - Создать DELETE /api/groups/[id] для удаления группы
  - Добавить валидацию входных данных


  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 6.1, 6.2, 6.3, 6.4, 6.5, 7.1, 7.2_

- [ ] 4.2 Реализовать API для управления участниками
  - Создать POST /api/groups/[id]/join для присоединения к группе

  - Создать POST /api/groups/[id]/leave для выхода из группы

  - Создать GET /api/groups/[id]/members для получения списка участников
  - Добавить обновление счетчика участников
  - Добавить логику передачи владельца при выходе
  - _Requirements: 3.1, 3.2, 3.3, 3.4, 5.1, 5.2, 5.3, 5.4, 5.5, 8.1, 8.2_


- [x] 4.3 Реализовать API для сообщений


  - Создать GET /api/groups/[id]/messages для получения сообщений
  - Создать POST /api/groups/[id]/messages для отправки сообщения
  - Добавить пагинацию для сообщений (50 за раз)
  - Добавить валидацию длины сообщения (1-1000 символов)
  - _Requirements: 4.1, 4.2, 4.3, 4.5, 4.6_


- [ ] 5. Создать Community Hub страницу
  - Создать src/app/community/page.tsx с 4 разделами
  - Реализовать CommunityHub компонент с навигацией
  - Добавить карточки для Лидерборда, Групп, Обсуждений, Найти напарника
  - Добавить кнопку "Назад" для возврата на главную
  - Стилизовать в соответствии с дизайном из скриншота

  - _Requirements: 1.1_

- [ ] 6. Создать страницу списка групп
- [ ] 6.1 Реализовать основную страницу и компоненты
  - Создать src/app/community/groups/page.tsx
  - Реализовать GroupsList компонент для отображения списка


  - Реализовать GroupCard компонент для карточки группы
  - Добавить кнопку "Создать группу"
  - Интегрировать с groups-store для получения данных
  - _Requirements: 1.1, 1.2, 1.5_

- [ ] 6.2 Реализовать фильтрацию и поиск
  - Реализовать GroupFilters компонент

  - Добавить поле поиска по названию группы


  - Добавить фильтр по языку программирования
  - Подключить к store для фильтрации
  - _Requirements: 1.3, 1.4_

- [ ] 6.3 Реализовать функционал присоединения к группе
  - Добавить кнопку "Присоединиться" на GroupCard


  - Реализовать обработчик присоединения
  - Показать индикатор для групп, где пользователь уже участник
  - Показать кнопку "Открыть" для групп пользователя
  - Добавить toast уведомления об успехе/ошибке
  - _Requirements: 3.1, 3.2, 3.3, 3.5_



- [ ] 7. Создать диалог создания группы
  - Реализовать CreateGroupDialog компонент
  - Добавить форму с полями: название, описание, язык
  - Добавить валидацию: название 3-50 символов, описание 10-500 символов
  - Реализовать обработчик создания группы
  - Добавить проверку лимита (максимум 3 группы)
  - Показать toast уведомления об успехе/ошибке
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7_


- [ ] 8. Создать страницу детальной информации о группе
- [ ] 8.1 Реализовать основную страницу и layout
  - Создать src/app/community/groups/[groupId]/page.tsx
  - Реализовать GroupDetail компонент
  - Добавить заголовок с названием группы и кнопкой настроек

  - Добавить кнопку "Назад" для возврата к списку
  - Интегрировать с groups-store для получения данных группы
  - _Requirements: 4.1, 6.1, 6.6_

- [ ] 8.2 Реализовать список участников
  - Реализовать GroupMembers компонент
  - Отображать аватар, имя и статус онлайн для каждого участника


  - Показать специальный значок для владельца группы
  - Отображать дату присоединения участника
  - Сортировать список с владельцем в начале
  - _Requirements: 8.1, 8.2, 8.3, 8.4, 8.5_

- [ ] 8.3 Реализовать групповой чат
  - Реализовать GroupChat компонент
  - Реализовать MessageList для отображения истории сообщений


  - Реализовать MessageInput для ввода и отправки сообщений
  - Отображать сообщения в хронологическом порядке
  - Показать аватар и имя отправителя для каждого сообщения
  - Добавить метку времени для каждого сообщения
  - Ограничить длину сообщения до 1000 символов
  - _Requirements: 4.1, 4.2, 4.3, 4.5, 4.6_


- [ ] 8.4 Добавить функционал выхода из группы
  - Добавить кнопку "Покинуть группу"
  - Реализовать диалог подтверждения выхода
  - Реализовать обработчик выхода из группы
  - Перенаправить на страницу списка групп после выхода
  - Добавить toast уведомление об успехе
  - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5_


- [ ] 9. Реализовать real-time обновления для чата
  - Настроить Supabase Realtime subscription для новых сообщений
  - Добавить автоматическое обновление списка сообщений
  - Реализовать отображение новых сообщений в реальном времени
  - Добавить подписку на изменения статуса участников
  - Реализовать отписку при размонтировании компонента

  - _Requirements: 4.4_



- [ ] 10. Создать настройки группы для владельца
  - Реализовать GroupSettings компонент
  - Добавить форму редактирования названия, описания и языка

  - Показать настройки только для владельца группы
  - Реализовать обработчик сохранения изменений
  - Добавить кнопку "Удалить группу" с подтверждением
  - Реализовать обработчик удаления группы
  - Добавить toast уведомления об успехе/ошибке

  - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 7.1, 7.2, 7.3, 7.4, 7.5_

- [ ] 11. Добавить интернационализацию для групп
  - Создать src/lib/i18n/ru/groups.ts с русскими переводами
  - Создать src/lib/i18n/en/groups.ts с английскими переводами
  - Добавить переводы для всех UI элементов

  - Добавить переводы для сообщений об ошибках
  - Интегрировать с существующей системой i18n
  - _Requirements: All_

- [ ] 12. Добавить обработку ошибок и валидацию
  - Создать enum GroupErrorCode с типами ошибок
  - Реализовать client-side валидацию форм
  - Добавить server-side валидацию в API routes


  - Реализовать понятные сообщения об ошибках
  - Добавить toast уведомления для ошибок
  - Добавить fallback на локальное хранилище при проблемах с сетью
  - _Requirements: All_

- [ ] 13. Оптимизация производительности
  - Добавить пагинацию для сообщений (загрузка по 50)
  - Реализовать debouncing для поиска и фильтрации
  - Добавить кэширование списка групп в store
  - Реализовать optimistic updates для отправки сообщений
  - Добавить skeleton loaders для состояния загрузки
  - _Requirements: All_

- [ ] 14. Интеграция с существующими функциями
- [ ] 14.1 Интеграция с профилем
  - Добавить отображение групп пользователя в профиле
  - Добавить статистику: количество групп, сообщений
  - Добавить ссылки на активные группы
  - _Requirements: All_

- [ ] 14.2 Интеграция с Telegram ботом
  - Добавить уведомления о новых сообщениях в группах
  - Реализовать дайджест активности группы
  - Добавить команды для управления группами
  - _Requirements: All_

- [ ] 14.3 Добавить достижения для групп
  - Создать достижение "Социальный" - создать первую группу
  - Создать достижение "Командный игрок" - присоединиться к 5 группам
  - Создать достижение "Болтун" - отправить 100 сообщений
  - Создать достижение "Лидер сообщества" - группа достигла 20 участников
  - Интегрировать с achievements-store
  - _Requirements: All_

- [ ] 15. Адаптивный дизайн и анимации
  - Реализовать адаптивную верстку для мобильных устройств
  - Добавить полноэкранный режим чата на мобильных
  - Реализовать адаптивную сетку для планшетов
  - Добавить Framer Motion анимации для переходов
  - Добавить анимацию появления новых сообщений
  - Реализовать плавные переходы между страницами
  - _Requirements: All_

- [ ] 16. Написать E2E тесты
  - Создать tests/e2e/groups.spec.ts
  - Написать тест для создания группы
  - Написать тест для присоединения к группе
  - Написать тест для отправки и получения сообщений
  - Написать тест для выхода из группы
  - Написать тест для удаления группы (владелец)
  - _Requirements: All_
