# –í–∏beStudy Telegram Bot - –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (15+ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤)
- ‚úÖ Next.js API Routes –¥–ª—è webhooks
- ‚úÖ node-telegram-bot-api –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Telegram
- ‚úÖ Supabase –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ GPT Lama –¥–ª—è AI Mentor

### üì¶ –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

**1. Bot Infrastructure**
- `lib/config/bot-env.ts` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `lib/bot/client.ts` - Bot singleton
- `lib/bot/commands.ts` - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
- `lib/types/bot.ts`, `lib/types/quest.ts` - TypeScript —Ç–∏–ø—ã

**2. Database Layer**
- `supabase/migrations/bot-schema.sql` - 5 —Ç–∞–±–ª–∏—Ü + —Ñ—É–Ω–∫—Ü–∏–∏
- `lib/db/bot-repository.ts` - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏

**3. Core Features**
- `lib/modules/quests/service.ts` - –°–∏—Å—Ç–µ–º–∞ –∫–≤–µ—Å—Ç–æ–≤
- `lib/modules/mentor/gpt-lama.ts` - AI Mentor
- `lib/modules/leaderboard/service.ts` - –†–µ–π—Ç–∏–Ω–≥–∏ —Å –∫—ç—à–µ–º
- `lib/modules/notifications/scheduler.ts` - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

**4. UI Components**
- `lib/ui/keyboards/main-menu.ts` - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `lib/ui/keyboards/leaderboard.ts` - –†–µ–π—Ç–∏–Ω–≥–∏
- `lib/ui/messages/formatters.ts` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**5. API Endpoints**
- `app/api/webhook/route.ts` - Telegram webhook
- `app/api/webhooks/task-completed/route.ts` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞

**–ö–æ–º–∞–Ω–¥—ã:**
- `/start` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è + –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- `/menu` - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/quests` - –°–ø–∏—Å–æ–∫ –∫–≤–µ—Å—Ç–æ–≤

**Inline –º–µ–Ω—é:**
- üìö –ú–æ–∏ —É—Ä–æ–∫–∏
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—É—Ä–æ–≤–µ–Ω—å, XP, –∑–∞–¥–∞—á–∏, —Å–µ—Ä–∏—è)
- üéØ –ö–≤–µ—Å—Ç—ã (3 –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö)
- üèÜ –†–µ–π—Ç–∏–Ω–≥ (–≥–ª–æ–±–∞–ª—å–Ω—ã–π, –Ω–µ–¥–µ–ª—å–Ω—ã–π, –ø–æ —è–∑—ã–∫–∞–º)
- ü§ñ AI Mentor (–ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã)
- üë§ –ü—Ä–æ—Ñ–∏–ª—å

**–ö–≤–µ—Å—Ç—ã (–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ):**
1. –†–µ—à–∏—Ç—å 3 –∑–∞–¥–∞—á–∏ (+50 XP)
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI Mentor (+20 XP)
3. –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Å–µ—Ä–∏—é (+30 XP)

**–†–µ–π—Ç–∏–Ω–≥–∏:**
- üåç –ì–ª–æ–±–∞–ª—å–Ω—ã–π (—Ç–æ–ø 50)
- üìÖ –ù–µ–¥–µ–ª—å–Ω—ã–π (—Ç–æ–ø 25)
- üíª –ü–æ —è–∑—ã–∫–∞–º (Python, JS, TS, Java, C++, C#)

**AI Mentor:**
- –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–¥–∞
- –ü–æ–º–æ—â—å —Å –æ—à–∏–±–∫–∞–º–∏
- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –∑–∞–¥–∞—á
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ (24—á)

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:**
- Daily quest reset (00:00 UTC)
- Weekly leaderboard reset (Monday 00:00)
- Inactivity reminders (10:00 UTC)

**–ë–µ–π–¥–∂–∏:**
- üå± –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏ (1 –∑–∞–¥–∞—á–∞)
- üî• –ù–µ–¥–µ–ª—è —Å–∏–ª—ã (7 –¥–Ω–µ–π —Å–µ—Ä–∏–∏)
- üî•üî• –ú–µ—Å—è—Ü —É–ø–æ—Ä—Å—Ç–≤–∞ (30 –¥–Ω–µ–π)
- üí™ –†–µ—à–∞—Ç–µ–ª—å (10 –∑–∞–¥–∞—á)
- üèÜ –ú–∞—Å—Ç–µ—Ä –∑–∞–¥–∞—á (50 –∑–∞–¥–∞—á)
- ‚≠ê –£—Ä–æ–≤–µ–Ω—å 5, ‚≠ê‚≠ê –£—Ä–æ–≤–µ–Ω—å 10

### üìä Database Schema

**–¢–∞–±–ª–∏—Ü—ã:**
1. `bot_users` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞
2. `user_quests` - –ö–≤–µ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. `badges` - –ú–∞—Å—Ç–µ—Ä-—Å–ø–∏—Å–æ–∫ –±–µ–π–¥–∂–µ–π
4. `user_badges` - –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –±–µ–π–¥–∂–∏
5. `seasonal_events` - –°–µ–∑–æ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è

**–§—É–Ω–∫—Ü–∏–∏:**
- `update_user_xp()` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ XP –∏ —É—Ä–æ–≤–Ω—è
- `update_user_streak()` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–∏–∏

### üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí –ë–æ—Ç:**
- Webhook –ø—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ XP
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–≤–µ—Å—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–π–¥–∂–µ–π
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ë–æ—Ç ‚Üí GPT Lama:**
- –ó–∞–ø—Ä–æ—Å—ã –∫ AI
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- Timeout 30 —Å–µ–∫
- –†—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ (development):
```bash
npm run dev
```
–ë–æ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å Next.js

### –ó–∞–ø—É—Å–∫ scheduler:
```bash
node scripts/start-scheduler.js
```

### –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î:
–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ `supabase/migrations/bot-schema.sql` –≤ Supabase SQL Editor

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
TELEGRAM_BOT_TOKEN=your_token
HF_TOKEN=your_gpt_lama_key
HF_API_BASE_URL=https://api.gptlama.ru/v1
HF_MODEL=gpt-4o-mini
```

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 15+
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~2000+
- **–ú–æ–¥—É–ª–µ–π:** 8
- **API endpoints:** 2
- **–ö–æ–º–∞–Ω–¥ –±–æ—Ç–∞:** 4+
- **Callback handlers:** 10+
- **Cron jobs:** 3
- **–¢–∞–±–ª–∏—Ü –ë–î:** 5
- **–ë–µ–π–¥–∂–µ–π:** 7

## ‚ú® –ß—Ç–æ –¥–∞–ª—å—à–µ?

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- [ ] Social features (–¥—Ä—É–∑—å—è, –≥—Ä—É–ø–ø—ã)
- [ ] Seasonal events (—Ö—ç–ª–ª–æ—É–∏–Ω, –Ω–æ–≤—ã–π –≥–æ–¥)
- [ ] Unit + Integration —Ç–µ—Å—Ç—ã
- [ ] Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- [ ] Monitoring (Sentry)
- [ ] Analytics dashboard

---

**–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ**
